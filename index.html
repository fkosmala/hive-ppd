
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <title>Hive proposal Display</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/css/bootstrap.min.css" integrity="sha512-Ez0cGzNzHR1tYAv56860NLspgUGuQw16GiOOp/I2LuTmpSK9xDXlgJz3XN4cnpXWDmkNBKXR/VDMTCnAaEooxA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<style>
		.rotate {
			background-color: black;
			color: white;
      margin: 0;
			position: absolute;
		 	transform: rotate(90deg);
		 	transform-origin: bottom left;
			width: 100vh;
			height: 100vw;
			object-fit: cover;
			top: -100vw;
			visibility: visible;
		 }
		h1 {font-size: 42pt;}
		img {max-height: 400px;}
		.top {margin-top: 100px;}
	</style>
</head>
<body class="rotate">
	<div class="container">
		<div class="row top">
		  <div class="col-4 ms-text-center">
		    <img class="img-fluid" src="./logo.jpg" alt="SuperHive Logo" />
		  </div>
		  <div class="col">
				<h1>Proposal <span id="propId" class="text-danger"></span></h1>
				<h2 id="propSubject"></h2>
				<p>Created by <span id="propCreator"></span> for <span id="propReceiver"></span>
				
				<hr>
				
				<div class="progress">
					<div id="progress" class="progress-bar progress-bar-striped bg-danger" role="progressbar" style="width: 1%" aria-valuemin="0" aria-valuemax="100"></div>
				</div>
				
				<hr />
				
				<h3>Vote value : <span id="propHP"></span> HP</h3>
				<h3><span id="percent"></span>% to fund the proposal</h3>
			</div>
		</div>
	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script>
		var node = "https://api.openhive.network";
		var target = 29076039;
		var formatter = new Intl.NumberFormat('en-US');
		var proposalID = 211;
		
		$(function() {
			function getProposal() {
				$.ajax({
					url: node,
					type: "POST",
					dataType: "json",
					contentType: 'application/json',
					data: '{"jsonrpc":"2.0", "method":"condenser_api.get_dynamic_global_properties", "params":[], "id":0}',
					cache: false,
		  		processData: false
				}).done(function( data ) {
					var tvfh = parseFloat(data.result.total_vesting_fund_hive)
					var tvs = parseFloat(data.result.total_vesting_shares);
					var total = (tvfh / tvs)/1000000;
					$.ajax({
						url: node,
						type: "POST",
						dataType: "json",
						contentType: 'application/json',
						data: '{"jsonrpc":"2.0", "method":"condenser_api.find_proposals", "params":[['+proposalID+']], "id":0}',
						cache: false,
						processData: false
					}).done(function( data ) {
						result = data.result[0];
						$('#propId').text('#'+result.proposal_id);
						$('#propSubject').text(result.subject);
						$('#propCreator').text(result.creator);
						$('#propReceiver').text(result.receiver);
						totalHP = (result.total_votes * total);
						$('#propHP').text(formatter.format(parseInt(totalHP)));
						percent = ((totalHP/target)*100).toFixed(2);
						$('#percent').text(percent);
						$('#progress').css('width', percent+'%');
					});
				});
			}
			
			getProposal();
			setInterval(getProposal, 120000);
		});
	</script>
</body>
</html>
